@model ICStars2_0.BusinessLayer.SteansSettings.Model.QuarterListSettings
@{
    ViewBag.Title = "QuarterYear Settings";
    Layout = "~/Areas/SHTracker/Views/Shared/_Layout.cshtml";
}
@section Head
{
    <style type="text/css">
        table{ width: 100%;}
        td #QuarterList,td p,td ul,form{ float: left;}
        td p input,select,form input{ width: 130px;}
        td p{ text-align: right;}
        td ul li{ padding-left: 20px;text-align: left;line-height: 20px;}
    </style>
    @Scripts.Render("~/bundles/jquery")
    <script type="text/javascript">
        function getOptionValues($array) {
            var result = "";
            $array.each(function () {
                result += "," + $(this).val();
            });
            return result;
        }
        function checkCurrentQuarter() {
            var result = true;
            var fallStartMonth = 8;
            var fallStartDay = 27;
            var fallEndMonth = 11;
            var fallEndDay = 31;

            var winterStartMonth = 1;
            var winterStartDay = 1;
            var winterEndMonth = 3;
            var winterEndDay = 31;

            var springStartMonth = 4;
            var springStartDay = 1;
            var springEndMonth = 6;
            var springEndDay = 15;

            var summerStartMonth = 6;
            var summerStartDay = 16;
            var summerEndMonth = 8;
            var summerEndDay = 22;

            var today = new Date();
            var todayMonth = today.getMonth() + 1;
            var todayDay = today.getDate();
            var currentQuarter = $("#currentQuarter").val();
            if (todayMonth >= fallStartMonth && todayMonth <= fallEndMonth && todayDay >= fallStartDay && todayDay <= fallEndDay) {
                if (currentQuarter == "Fall " + today.getFullYear()) return true;
                result = confirm("It is supposed to be Fall " + today.getFullYear() + "! If you are sure it is " + currentQuarter + ", please click OK; otherwise click cancel!");
            }
            if (todayMonth >= winterStartMonth && todayMonth <= winterEndMonth && todayDay >= winterStartDay && todayDay <= winterEndDay) {
                if (currentQuarter == "Winter " + today.getFullYear()) return true;
                result = confirm("It is supposed to be Winter " + (today.getFullYear() + 1) + "! If you are that it is " + currentQuarter + ", please click OK; otherwise click cancel!");
            }
            if (todayMonth >= springStartMonth && todayMonth <= springEndMonth && todayDay >= springStartDay && todayDay <= springEndDay) {
                if (currentQuarter == "Spring " + today.getFullYear()) return true;
                result = confirm("It is supposed to be Spring " + today.getFullYear() + "! If you are sure it is " + currentQuarter + ", please click OK; otherwise click cancel!");
            }
            if (todayMonth >= summerStartMonth && todayMonth <= summerEndMonth && todayDay >= summerStartDay && todayDay <= summerEndDay) {
                if (currentQuarter == "Summer " + today.getFullYear()) return true;
                result = confirm("It is supposed to be Summer " + today.getFullYear() + "! If you are sure it is " + currentQuarter + ", please click OK; otherwise click cancel!");
            }
            return result;
        }

        $(document).ready(function() {
            $("#QuarterList option").click(function() {
                $("#txtModify").val($(this).val());
            });
        });
        function selectAllOptions(id) {
            $("#QuarterList option").prop("selected", true);
            //var sel = document.getElementById(id);
            //for (var i = 0; i < sel.options.length; i++) {
            //    sel.options[i].selected = true;
            //}
        }
    </script>
}
<h2>QuarterYear Settings</h2>
<table>
    <tr>
        <td>Quarter List:</td>
        <td>
            <p style="width:100%;color:red;text-align:left;font-weight:bold;">Format: <span style="color:yellow;background-color:red;font-weight:bold">Quarter Year</span> (e.g. <span style="color:yellow;background-color:red;font-weight:bold">Spring 2013</span>)<br />
                The entry will not be recognized by system if it doesn't conform to the correct format!
            </p>
            <p>@using (Html.BeginForm("SaveQuarterYearSettings","System"))
               {
                   @Html.DropDownListFor(m=>m.QuarterList, Model.QuarterList.Select(q => new SelectListItem {Text = q, Value = q}), new {multiple = "multiple"})
                @Html.HiddenFor(m=>m.CurrentQuarter)
                   <br/>
                <input type="submit" onclick="selectAllOptions('QuarterList');" value="Save"/>
               }</p>
            <p><input id="txtAdd" type="text"/><input type="button" value="Add" onclick='$("#QuarterList").append("<option value=\"" + $("#txtAdd").val() + "\">" + $("#txtAdd").val() + "</option>")'/><br/>
                <input id="txtModify" type="text"/><input type="button" value="Modify" onclick='if ($("#txtModify").val() == "") { $("#txtModify").focus(); return false; } $("#QuarterList option:selected").val($("#txtModify").val()).text($("#txtModify").val());'/><br/>
                <input type="button" value="Delete" onclick='$("#QuarterList option:selected").remove();'/><br/>
                <input type="button" value="Move Up" onclick='var $selected = $("#QuarterList option:selected");$selected.insertBefore($selected.prev())'/><br/>
                <input type="button" value="Move Down" onclick='var $selected = $("#QuarterList option:selected"); $selected.insertAfter($selected.next())'/></p>
            <ul>
                <li><b>Fill out</b> the <b>textbox</b> on the left of the "Add" button, then <b>click</b> "Add" button to add.</li>
                <li><b>Double click</b> the <b>option</b> to modify, then <b>click</b> "Modify" button to save.</li>
                <li>Click the option, then click the "Delete" button to delete.</li>
                <li>Click the option, then click the "MoveUp" button to move the option up.</li>
                <li>Click the option, then click the "MoveDown" button to move the option down.</li>
            </ul>
        </td>
    </tr>
    <tr>
        <td></td>
        <td>@using (Html.BeginForm("SetCurrentQuarter","System"))
            {
                @Html.DropDownListFor(m => m.QuarterList, Model.QuarterList.Select(q => new SelectListItem {Text = q, Value = q}),new{@id="currentQuarter"})<input type="submit" value="Set As Current" onclick="return checkCurrentQuarter(); return false;"/>
<text>Current Quarter:</text>
                @Model.CurrentQuarter
            }
        </td>
    </tr>
</table>