@using ICStars2_0.Model
@model IEnumerable<ICStars2_0.Model.son_cboprogram>

@{
    ViewBag.Title = "CBOChoices";
    Layout = "~/Areas/SHTracker/Views/Shared/_Layout.cshtml";
}
@section head{
    <style type="text/css">
        .underline {
            border-bottom: solid 1px #ccc;
        }
    </style>
}
<h2>CBOChoices</h2>

<table width="100%">
    <tr>
        <th>
            @Html.DisplayNameFor(model => model.CBOName)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.ProgramName)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Location)
        </th>
        <th>Choices(Students)</th>
    </tr>

@foreach (var item in Model) {
    var students = ((IEnumerable<son_student>)ViewBag.Students).Where(s => ((IEnumerable<son_cbochoice>)ViewBag.CboChoices).Any(cc => cc.StudentID == s.StudentID && cc.CPID == item.CPID));
    <tr>
        <td>
            @Html.DisplayFor(modelItem => item.CBOName)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.ProgramName)
        </td>
        <td>
            @Html.DisplayFor(modelItem => item.Location)
        </td>

            @if (students.Count() > 0)
            {
                    foreach (son_student stu in students)
                    {
                            <td>@stu.Name</td>
                    }
            }
    </tr>
   
}

</table>
